/*
jQuery UI Virtual Keyboard
Version 1.9.8 minified

Author: Jeremy Satterfield
Modified: Rob Garrison (Mottie on github)
-----------------------------------------
Licensed under the MIT License

Caret code from jquery.caret.1.02.js
Licensed under the MIT License:
http://www.opensource.org/licenses/mit-license.php
-----------------------------------------
*/

(function(b){b.keyboard=function(f,l){var a=this,d;a.$el=b(f);a.el=f;a.$el.data("keyboard",a);a.init=function(){a.options=d=b.extend(!0,{},b.keyboard.defaultOptions,l);a.shiftActive=a.altActive=a.metaActive=a.sets=a.capsLock=!1;a.lastKeyset=[!1,!1,!1];a.rows=["","-shift","-alt","-alt-shift"];a.acceptedKeys=[];a.mappedKeys={};b('<\!--[if lte IE 8]><script>$("body").addClass("oldie");<\/script><![endif]--\>').appendTo("body").remove();a.msie=b("body").hasClass("oldie");a.allie=b.browser.msie;a.inPlaceholder= a.$el.attr("placeholder")||"";a.watermark="undefined"!==typeof document.createElement("input").placeholder&&""!==a.inPlaceholder;a.regex=b.keyboard.comboRegex;a.decimal=/^\./.test(d.display.dec)?!0:!1;a.repeatTime=1E3/d.repeatRate;a.temp=b('<input style="visibility:hidden" type="text" value="this is a test">').appendTo("body").caret(3,3);a.checkCaret=d.lockInput||3!==a.temp.caret().start?!0:!1;a.temp.remove();a.temp=["",0,0];b.each("initialized,visible,change,hidden,canceled,accepted,beforeClose".split(","), function(c,e){b.isFunction(d[e])&&a.$el.bind(e+".keyboard",d[e])});d.alwaysOpen&&(d.stayOpen=!0);d.stayOpen||b(document).bind("mousedown.keyboard keyup.keyboard",function(c){a.escClose(c)});a.$el.addClass("ui-keyboard-input "+d.css.input).attr({"aria-haspopup":"true",role:"textbox"});(a.$el.is(":disabled")||a.$el.attr("readonly"))&&a.$el.addClass("ui-keyboard-nokeyboard");d.openOn&&a.$el.bind(d.openOn+".keyboard",function(){a.focusOn()});!a.watermark&&""===a.$el.val()&&""!==a.inPlaceholder&&""!== a.$el.attr("placeholder")&&a.$el.addClass("ui-keyboard-placeholder").val(a.inPlaceholder);a.$el.trigger("initialized.keyboard",[a,a.el]);d.alwaysOpen&&a.reveal()};a.focusOn=function(){if(!a.isVisible||d.alwaysOpen)clearTimeout(a.timer),a.reveal(),setTimeout(function(){a.$preview.focus()},100)};a.reveal=function(){b(".ui-keyboard:not(.ui-keyboard-always-open)").hide();b(".ui-keyboard-has-focus").removeClass("ui-keyboard-has-focus");b(".ui-keyboard-input-current").removeClass("ui-keyboard-input-current"); if(a.$el.is(":disabled")||a.$el.attr("readonly"))a.$el.addClass("ui-keyboard-nokeyboard");else{a.$el.removeClass("ui-keyboard-nokeyboard");d.usePreview||a.$el.unbind(d.openOn?d.openOn+".keyboard":"");"undefined"===typeof a.$keyboard&&a.startup();!a.watermark&&a.el.value===a.inPlaceholder&&a.$el.removeClass("ui-keyboard-placeholder").val("");a.originalContent=a.$el.val();a.$preview.val(a.originalContent);d.acceptValid&&a.checkValid();var c,e=d.position;e.of=e.of||a.$el.data("keyboardPosition")||a.$el; e.collision=d.usePreview?e.collision||"fit fit":"flip flip";a.$el.addClass("ui-keyboard-input-current");a.isCurrent=!0;a.$keyboard.css({position:"absolute",left:0,top:0}).addClass("ui-keyboard-has-focus").show();d.usePreview&&a.msie&&("undefined"===typeof a.width&&(a.$preview.hide(),a.width=Math.ceil(a.$keyboard.width()),a.$preview.show()),a.$preview.width(a.width));a.$keyboard.position(e);b(window).resize(function(){a.isVisible&&a.$keyboard.position(e)});a.$preview.focus();a.isVisible=!0;a.checkDecimal(); a.lineHeight=parseInt(a.$preview.css("lineHeight"),10)||parseInt(a.$preview.css("font-size"),10)+4;a.msie&&(c=a.originalContent.length,c={start:c,end:c},a.lastCaret||(a.lastCaret=c),0===a.lastCaret.end&&0<a.lastCaret.start&&(a.lastCaret.end=a.lastCaret.start),0>a.lastCaret.start&&(a.lastCaret=c),a.$preview.caret(a.lastCaret.start,a.lastCaret.end));a.$el.trigger("visible.keyboard",[a,a.el]);return a}};a.startup=function(){a.$keyboard=a.buildKeyboard();a.$allKeys=a.$keyboard.find("button.ui-keyboard-button"); a.$preview=d.usePreview?a.$keyboard.find(".ui-keyboard-preview"):a.$el;a.preview=a.$preview[0];a.$decBtn=a.$keyboard.find(".ui-keyboard-dec");a.wheel=b.isFunction(b.fn.mousewheel);a.alwaysAllowed=[20,33,34,35,36,37,38,39,40,45,46];d.enterNavigation&&a.alwaysAllowed.push(13);a.lastCaret={start:0,end:0};a.$preview.bind("keypress.keyboard",function(c){var e=String.fromCharCode(c.charCode||c.which);a.checkCaret&&(a.lastCaret=a.$preview.caret());a.capsLock=65<=e&&90>=e&&!c.shiftKey||97<=e&&122>=e&&c.shiftKey? !0:!1;if(d.restrictInput){if((8===c.which||0===c.which)&&b.inArray(c.keyCode,a.alwaysAllowed))return;-1===b.inArray(e,a.acceptedKeys)&&c.preventDefault()}else if((c.ctrlKey||c.metaKey)&&(97===c.which||99===c.which||118===c.which||120<=c.which&&122>=c.which))return;a.hasMappedKeys&&a.mappedKeys.hasOwnProperty(e)&&(a.insertText(a.mappedKeys[e]),c.preventDefault());a.checkMaxLength()}).bind("keyup.keyboard",function(c){switch(c.which){case 9:a.tab&&!d.lockInput?(b.keyboard.keyaction.tab(a),a.tab=!1): c.preventDefault();break;case 27:return a.close(),!1}clearTimeout(a.throttled);a.throttled=setTimeout(function(){a.checkCombos()},100);a.checkMaxLength();a.$el.trigger("change.keyboard",[a,a.el])}).bind("keydown.keyboard",function(c){switch(c.which){case 9:if(d.tabNavigation){a.close(d.autoAccept);break}else return a.tab=!0,!1;case 13:b.keyboard.keyaction.enter(a,null,c);break;case 20:a.shiftActive=a.capsLock=!a.capsLock;a.showKeySet(this);break;case 86:if(c.ctrlKey||c.metaKey){if(d.preventPaste){c.preventDefault(); break}a.checkCombos()}}}).bind("mouseup.keyboard",function(){a.checkCaret&&(a.lastCaret=a.$preview.caret())}).bind("blur.keyboard",function(){if(d.alwaysOpen&&a.isCurrent&&!a.$el.hasClass("ui-keyboard-input-current"))return clearTimeout(a.timer),a.timer=setTimeout(function(){a.isCurrent&&!a.$el.hasClass("ui-keyboard-input-current")&&a.close(d.autoAccept)},300),!1});d.preventPaste&&(a.$preview.bind("contextmenu.keyboard",function(a){a.preventDefault()}),a.$el.bind("contextmenu.keyboard",function(a){a.preventDefault()})); d.appendLocally?a.$el.after(a.$keyboard):a.$keyboard.appendTo("body");a.$allKeys.bind(d.keyBinding.split(" ").join(".keyboard ")+".keyboard repeater.keyboard",function(c){var e;e=b.data(this,"key");var k=e.action.split(":")[0];a.$preview.focus();a.checkCaret&&a.$preview.caret(a.lastCaret.start,a.lastCaret.end);k.match("meta")&&(k="meta");if(b.keyboard.keyaction.hasOwnProperty(k)&&b(this).hasClass("ui-keyboard-actionkey")){if(!1===b.keyboard.keyaction[k](a,this,c))return}else"undefined"!==typeof e.action&& (e=a.wheel&&!b(this).hasClass("ui-keyboard-actionkey")?e.curTxt:e.action,a.insertText(e),!a.capsLock&&!d.stickyShift&&!c.shiftKey&&(a.shiftActive=!1,a.showKeySet(this)));a.checkCombos();a.checkMaxLength();a.$el.trigger("change.keyboard",[a,a.el]);a.$preview.focus();c.preventDefault()}).bind("mouseenter.keyboard mouseleave.keyboard",function(c){var e=b(this),k=b.data(this,"key");"mouseenter"===c.type&&"password"!==a.el.type&&e.addClass(d.css.buttonHover).attr("title",function(c,e){return a.wheel&& ""===e&&a.sets?d.wheelMessage:e});"mouseleave"===c.type&&(k.curTxt=k.original,k.curNum=0,b.data(this,"key",k),e.removeClass("password"===a.el.type?"":d.css.buttonHover).attr("title",function(a,c){return c===d.wheelMessage?"":c}).find("span").text(k.original))}).bind("mousewheel.keyboard",function(c,e){if(a.wheel){var d,f=b(this),g=b.data(this,"key");d=g.layers||a.getLayers(f);g.curNum+=0<e?-1:1;g.curNum>d.length-1&&(g.curNum=0);0>g.curNum&&(g.curNum=d.length-1);g.layers=d;g.curTxt=d[g.curNum];b.data(this, "key",g);f.find("span").text(d[g.curNum]);return!1}}).bind("mouseup.keyboard mouseleave.kb touchend.kb touchmove.kb touchcancel.kb",function(){a.isVisible&&a.$preview.focus();a.mouseRepeat=[!1,""];return!1}).filter(":not(.ui-keyboard-actionkey)").add(".ui-keyboard-tab, .ui-keyboard-bksp, .ui-keyboard-space, .ui-keyboard-enter",a.$keyboard).bind("mousedown.kb touchstart.kb",function(){var c=b(this);a.mouseRepeat=[!0,c];setTimeout(function(){a.mouseRepeat[0]&&a.mouseRepeat[1]===c&&a.repeatKey(c)},d.repeatDelay); return!1})};a.insertText=function(c){var d,f;f=a.$preview.val();var b=a.$preview.caret(),g=a.$preview.scrollLeft();d=a.$preview.scrollTop();var h=f.length;b.end<b.start&&(b.end=b.start);b.start>h&&(b.end=b.start=h);"TEXTAREA"===a.preview.tagName&&(a.msie&&"\n"===f.substr(b.start,1)&&(b.start+=1,b.end+=1),f=f.split("\n").length-1,a.preview.scrollTop=0<f?a.lineHeight*f:d);d="bksp"===c&&b.start===b.end?!0:!1;c="bksp"===c?"":c;f=b.start+(d?-1:c.length);g+=parseInt(a.$preview.css("fontSize"),10)*("bksp"=== c?-1:1);a.$preview.val(a.$preview.val().substr(0,b.start-(d?1:0))+c+a.$preview.val().substr(b.end)).caret(f,f).scrollLeft(g);a.checkCaret&&(a.lastCaret={start:f,end:f})};a.checkMaxLength=function(){var c,e=a.$preview.val();!1!==d.maxLength&&e.length>d.maxLength&&(c=Math.min(a.$preview.caret().start,d.maxLength),a.$preview.val(e.substring(0,d.maxLength)),a.$preview.caret(c,c),a.lastCaret={start:c,end:c});a.$decBtn.length&&a.checkDecimal()};a.repeatKey=function(c){c.trigger("repeater.keyboard");a.mouseRepeat[0]&& setTimeout(function(){a.repeatKey(c)},a.repeatTime)};a.showKeySet=function(c){var e="",b=(a.shiftActive?1:0)+(a.altActive?2:0);a.shiftActive||(a.capsLock=!1);if(a.metaActive){if(e=c&&c.name&&/meta/.test(c.name)?c.name:"",""===e?e=!0===a.metaActive?"":a.metaActive:a.metaActive=e,!d.stickyShift&&a.lastKeyset[2]!==a.metaActive||(a.shiftActive||a.altActive)&&!a.$keyboard.find(".ui-keyboard-keyset-"+e+a.rows[b]).length)a.shiftActive=a.altActive=!1}else!d.stickyShift&&a.lastKeyset[2]!==a.metaActive&&a.shiftActive&& (a.shiftActive=a.altActive=!1);b=(a.shiftActive?1:0)+(a.altActive?2:0);e=0===b&&!a.metaActive?"-default":""===e?"":"-"+e;a.$keyboard.find(".ui-keyboard-keyset"+e+a.rows[b]).length?(a.$keyboard.find(".ui-keyboard-alt, .ui-keyboard-shift, .ui-keyboard-actionkey[class*=meta]").removeClass(d.css.buttonAction).end().find(".ui-keyboard-alt")[a.altActive?"addClass":"removeClass"](d.css.buttonAction).end().find(".ui-keyboard-shift")[a.shiftActive?"addClass":"removeClass"](d.css.buttonAction).end().find(".ui-keyboard-lock")[a.capsLock? "addClass":"removeClass"](d.css.buttonAction).end().find(".ui-keyboard-keyset").hide().end().find(".ui-keyboard-keyset"+e+a.rows[b]).show().end().find(".ui-keyboard-actionkey.ui-keyboard"+e).addClass(d.css.buttonAction),a.lastKeyset=[a.shiftActive,a.altActive,a.metaActive]):(a.shiftActive=a.lastKeyset[0],a.altActive=a.lastKeyset[1],a.metaActive=a.lastKeyset[2])};a.checkCombos=function(){var c,e,b,f,g=a.$preview.val(),h=a.$preview.caret(),j=g.length;h.end<h.start&&(h.end=h.start);h.start>j&&(h.end= h.start=j);a.msie&&"\n"===g.substr(h.start,1)&&(h.start+=1,h.end+=1);d.useCombos&&(g=g.replace(a.regex,function(a,c,e){return d.combos.hasOwnProperty(c)?d.combos[c][e]||a:a}));if(d.restrictInput&&""!==g){b=g;e=a.acceptedKeys.length;for(c=0;c<e;c++)""!==b&&(f=a.acceptedKeys[c],0<=g.indexOf(f)&&(/[\[|\]|\\|\^|\$|\.|\||\?|\*|\+|\(|\)|\{|\}]/g.test(f)&&(f="\\"+f),b=b.replace(RegExp(f,"g"),"")));""!==b&&(g=g.replace(b,""))}h.start+=g.length-j;h.end+=g.length-j;a.$preview.val(g);a.$preview.caret(h.start, h.end);a.preview.scrollTop=a.lineHeight*(g.substring(0,h.start).split("\n").length-1);a.lastCaret={start:h.start,end:h.end};d.acceptValid&&a.checkValid();return g};a.checkValid=function(){var c=!0;d.validate&&"function"===typeof d.validate&&(c=d.validate(a,a.$preview.val(),!1));a.$keyboard.find(".ui-keyboard-accept")[c?"removeClass":"addClass"]("disabled")[c?"removeAttr":"attr"]("disabled","disabled").attr("aria-disabled",!c)};a.checkDecimal=function(){a.decimal&&/\./g.test(a.preview.value)||!a.decimal&& /\,/g.test(a.preview.value)?a.$decBtn.attr({disabled:"disabled","aria-disabled":"true"}).removeClass(d.css.buttonDefault+" "+d.css.buttonHover).addClass(d.css.buttonDisabled):a.$decBtn.removeAttr("disabled").attr({"aria-disabled":"false"}).addClass(d.css.buttonDefault).removeClass(d.css.buttonDisabled)};a.getLayers=function(a){var d;d=a.attr("data-pos");return a.closest(".ui-keyboard").find('button[data-pos="'+d+'"]').map(function(){return b(this).find("> span").text()}).get()};a.switchInput=function(c, e){if("function"===typeof d.switchInput)d.switchInput(a,c,e);else{a.close(e);var f=b(".ui-keyboard-input:not(.ui-keyboard-preview)"),i=f.index(a.$el)+(c?1:-1);i>f.length-1&&(i=0);f.eq(i).focus()}return!1};a.close=function(c){if(a.isVisible){clearTimeout(a.throttled);a.isCurrent=!1;var e=c?a.checkCombos():a.originalContent;if(c&&d.validate&&"function"===typeof d.validate&&!d.validate(a,e,!0))return;a.$el.removeClass("ui-keyboard-input-current").trigger(d.alwaysOpen?"":"beforeClose.keyboard",[a,a.el, c||!1]).val(e).scrollTop(a.el.scrollHeight).trigger(c?"accepted.keyboard":"canceled.keyboard",[a,a.el]).trigger(d.alwaysOpen?"inactive.keyboard":"hidden.keyboard",[a,a.el]);!d.usePreview&&""!==d.openOn&&a.$el.bind(d.openOn+".keyboard",function(){a.focusOn()});d.alwaysOpen||(a.$keyboard.hide(),a.isVisible=!1);!a.watermark&&""===a.el.value&&""!==a.inPlaceholder&&a.$el.addClass("ui-keyboard-placeholder").val(a.inPlaceholder)}return!1};a.accept=function(){a.close(!0)};a.escClose=function(c){a.isVisible&& ("keyup"===c.type&&27===c.which&&a.close(),"mousedown"===c.type&&c.target!==a.el&&b(c.target).closest(".ui-keyboard")[0]!==a.$keyboard[0]&&(a.allie&&c.preventDefault(),a.close(d.autoAccept)))};a.keyBtn=b("<button />").attr({role:"button","aria-disabled":"false",tabindex:"-1"}).addClass("ui-keyboard-button");a.addKey=function(c,e,f){var i,g,h,e=!0===f?c:d.display[e]||c,j=!0===f?c.charCodeAt(0):c;/\(.+\)/.test(e)&&(g=e.replace(/\(([^()]+)\)/,""),i=e.match(/\(([^()]+)\)/)[1],e=g,h=g.split(":"),g=""!== h[0]&&1<h.length?h[0]:g,a.mappedKeys[i]=g);h=e.split(":");""===h[0]&&""===h[1]&&(e=":");e=""!==h[0]&&1<h.length?b.trim(h[0]):e;i=1<h.length?b.trim(h[1]).replace(/_/g," ")||"":"";g=1<e.length?" ui-keyboard-widekey":"";g+=f?"":" ui-keyboard-actionkey";return a.keyBtn.clone().attr({"data-value":e,name:j,"data-pos":a.temp[1]+","+a.temp[2],title:i}).data("key",{action:c,original:e,curTxt:e,curNum:0}).addClass("ui-keyboard-"+j+g+" "+d.css.buttonDefault).html("<span>"+e+"</span>").appendTo(a.temp[0])};a.buildKeyboard= function(){var c,e,f,i,g,h,j,l=0,o=b("<div />").addClass("ui-keyboard "+d.css.container+(d.alwaysOpen?" ui-keyboard-always-open":"")).attr({role:"textbox"}).hide();d.usePreview?a.$preview=a.$el.clone(!1).removeAttr("id").removeClass("ui-keyboard-placeholder").addClass("ui-keyboard-preview "+d.css.input).show():(a.$preview=a.$el,d.position.at=d.position.at2);a.$preview.attr(d.lockInput?{readonly:"readonly"}:{});d.usePreview&&b("<div />").addClass("ui-keyboard-preview-wrapper").append(a.$preview).appendTo(o); if("custom"===d.layout||!b.keyboard.layouts.hasOwnProperty(d.layout))d.layout="custom",b.keyboard.layouts.custom=d.customLayout||{"default":["{cancel}"]};b.each(b.keyboard.layouts[d.layout],function(n,p){if(""!==n){l++;f=b("<div />").attr("name",n).addClass("ui-keyboard-keyset ui-keyboard-keyset-"+n).appendTo(o)["default"===n?"show":"hide"]();for(e=0;e<p.length;e++){i=b.trim(p[e]).replace(/\{(\.?)[\s+]?:[\s+]?(\.?)\}/g,"{$1:$2}");h=i.split(/\s+/);for(g=0;g<h.length;g++)if(a.temp=[f,e,g],0!==h[g].length)if(/^\{\S+\}$/.test(h[g]))if(c= h[g].match(/^\{(\S+)\}$/)[1].toLowerCase(),/^sp:((\d+)?(\.\d+)?)$/.test(c)&&(j=c.match(/^sp:((\d+)?(\.\d+)?)$/)[1]||0,b("<span>&nbsp;</span>").css("margin","0 "+j+"em").addClass("ui-keyboard-button ui-keyboard-spacer").appendTo(f)),/^meta\d+\:?(\w+)?/.test(c))a.addKey(c,c);else switch(c){case "a":case "accept":a.addKey("accept",c).addClass(d.css.buttonAction);break;case "alt":case "altgr":a.addKey("alt","alt");break;case "b":case "bksp":a.addKey("bksp",c);break;case "c":case "cancel":a.addKey("cancel", c).addClass(d.css.buttonAction);break;case "combo":a.addKey("combo","combo").addClass(d.css.buttonAction);break;case "dec":a.acceptedKeys.push(a.decimal?".":",");a.addKey("dec","dec");break;case "e":case "enter":a.addKey("enter",c).addClass(d.css.buttonAction);break;case "s":case "shift":a.addKey("shift",c);break;case "sign":a.acceptedKeys.push("-");a.addKey("sign","sign");break;case "space":a.acceptedKeys.push(" ");a.addKey("space","space");break;case "t":case "tab":a.addKey("tab",c);break;default:b.keyboard.keyaction.hasOwnProperty(c)&& a.addKey(c,c)}else a.acceptedKeys.push(h[g].split(":")[0]),a.addKey(h[g],h[g],!0);f.find(".ui-keyboard-button:last").after('<br class="ui-keyboard-button-endrow">')}}});1<l&&(a.sets=!0);a.hasMappedKeys=!b.isEmptyObject(a.mappedKeys);return o};a.destroy=function(){b(document).unbind("mousedown.keyboard keyup.keyboard");a.$keyboard&&a.$keyboard.remove();var c=d.openOn+",accepted,beforeClose,blur,canceled,change,contextmenu,hidden,initialized,keydown,keypress,keyup,visible".split(",").join(".keyboard "); a.$el.removeClass("ui-keyboard-input ui-keyboard-placeholder ui-keyboard-notallowed ui-keyboard-always-open "+d.css.input).removeAttr("aria-haspopup").removeAttr("role").unbind(c+".keyboard").removeData("keyboard")};a.init()};b.keyboard.keyaction={accept:function(f){f.close(!0);return!1},alt:function(f,b){f.altActive=!f.altActive;f.showKeySet(b)},bksp:function(f){f.insertText("bksp")},cancel:function(f){f.close();return!1},clear:function(f){f.$preview.val("")},combo:function(f){var b=!f.options.useCombos; f.options.useCombos=b;f.$keyboard.find(".ui-keyboard-combo")[b?"addClass":"removeClass"](f.options.css.buttonAction);b&&f.checkCombos();return!1},dec:function(b){b.insertText(b.decimal?".":",")},enter:function(b,l,a){var l=b.el.tagName,d=b.options;if(a.shiftKey)return d.enterNavigation?b.switchInput(!a[d.enterMod],!0):b.close(!0);if(d.enterNavigation&&("TEXTAREA"!==l||a[d.enterMod]))return b.switchInput(!a[d.enterMod],d.autoAccept);"TEXTAREA"===l&&"BUTTON"===a.target.parentNode.tagName&&b.insertText("\n")}, lock:function(b,l){b.lastKeyset[0]=b.shiftActive=b.capsLock=!b.capsLock;b.showKeySet(l)},meta:function(f,l){f.metaActive=b(l).hasClass(f.options.css.buttonAction)?!1:!0;f.showKeySet(l)},shift:function(b,l){b.lastKeyset[0]=b.shiftActive=!b.shiftActive;b.showKeySet(l)},sign:function(b){/^\-?\d*\.?\d*$/.test(b.$preview.val())&&b.$preview.val(-1*b.$preview.val())},space:function(b){b.insertText(" ")},tab:function(b){if("INPUT"===b.el.tagName)return!1;b.insertText("\t")}};b.keyboard.layouts={alpha:{"default":["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}", "{tab} a b c d e f g h i j [ ] \\","k l m n o p q r s ; ' {enter}","{shift} t u v w x y z , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} A B C D E F G H I J { } |",'K L M N O P Q R S : " {enter}',"{shift} T U V W X Y Z < > ? {shift}","{accept} {space} {cancel}"]},qwerty:{"default":["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}", "{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {space} {cancel}"]},international:{"default":["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {alt} {space} {alt} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {alt} {space} {alt} {cancel}"], alt:["~ \u00a1 \u00b2 \u00b3 \u00a4 \u20ac \u00bc \u00bd \u00be \u2018 \u2019 \u00a5 \u00d7 {bksp}","{tab} \u00e4 \u00e5 \u00e9 \u00ae \u00fe \u00fc \u00fa \u00ed \u00f3 \u00f6 \u00ab \u00bb \u00ac","\u00e1 \u00df \u00f0 f g h j k \u00f8 \u00b6 \u00b4 {enter}","{shift} \u00e6 x \u00a9 v b \u00f1 \u00b5 \u00e7 > \u00bf {shift}","{accept} {alt} {space} {alt} {cancel}"],"alt-shift":["~ \u00b9 \u00b2 \u00b3 \u00a3 \u20ac \u00bc \u00bd \u00be \u2018 \u2019 \u00a5 \u00f7 {bksp}","{tab} \u00c4 \u00c5 \u00c9 \u00ae \u00de \u00dc \u00da \u00cd \u00d3 \u00d6 \u00ab \u00bb \u00a6", "\u00c4 \u00a7 \u00d0 F G H J K \u00d8 \u00b0 \u00a8 {enter}","{shift} \u00c6 X \u00a2 V B \u00d1 \u00b5 \u00c7 . \u00bf {shift}","{accept} {alt} {space} {alt} {cancel}"]},dvorak:{"default":["` 1 2 3 4 5 6 7 8 9 0 [ ] {bksp}","{tab} ' , . p y f g c r l / = \\","a o e u i d h t n s - {enter}","{shift} ; q j k x b m w v z {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) { } {bksp}",'{tab} " < > P Y F G C R L ? + |',"A O E U I D H T N S _ {enter}","{shift} : Q J K X B M W V Z {shift}", "{accept} {space} {cancel}"]},num:{"default":"= ( ) {b},{clear} / * -,7 8 9 +,4 5 6 {sign},1 2 3 %,0 . {a} {c}".split(",")}};b.keyboard.defaultOptions={layout:"qwerty",customLayout:null,position:{of:null,my:"center top",at:"center top",at2:"center bottom"},usePreview:!0,alwaysOpen:!1,stayOpen:!1,display:{a:"\u2714:Accept (Shift-Enter)",accept:"Accept:Accept (Shift-Enter)",alt:"AltGr:Alternate Graphemes",b:"\u2190:Backspace",bksp:"Bksp:Backspace",c:"\u2716:Cancel (Esc)",cancel:"Cancel:Cancel (Esc)", clear:"C:Clear",combo:"\u00f6:Toggle Combo Keys",dec:".:Decimal",e:"\u21b5:Enter",enter:"Enter:Enter",lock:"\u21ea Lock:Caps Lock",s:"\u21e7:Shift",shift:"Shift:Shift",sign:"\u00b1:Change Sign",space:"&nbsp;:Space",t:"\u21e5:Tab",tab:"\u21e5 Tab:Tab"},wheelMessage:"Use mousewheel to see other keys",css:{input:"ui-widget-content ui-corner-all",container:"ui-widget-content ui-widget ui-corner-all ui-helper-clearfix",buttonDefault:"ui-state-default ui-corner-all",buttonHover:"ui-state-hover",buttonAction:"ui-state-active", buttonDisabled:"ui-state-disabled"},autoAccept:!1,lockInput:!1,restrictInput:!1,acceptValid:!1,tabNavigation:!1,enterNavigation:!1,enterMod:"altKey",appendLocally:!1,stickyShift:!0,preventPaste:!1,maxLength:!1,repeatDelay:500,repeatRate:20,openOn:"focus",keyBinding:"mousedown",useCombos:!0,combos:{"`":{a:"\u00e0",A:"\u00c0",e:"\u00e8",E:"\u00c8",i:"\u00ec",I:"\u00cc",o:"\u00f2",O:"\u00d2",u:"\u00f9",U:"\u00d9",y:"\u1ef3",Y:"\u1ef2"},"'":{a:"\u00e1",A:"\u00c1",e:"\u00e9",E:"\u00c9",i:"\u00ed",I:"\u00cd", o:"\u00f3",O:"\u00d3",u:"\u00fa",U:"\u00da",y:"\u00fd",Y:"\u00dd"},'"':{a:"\u00e4",A:"\u00c4",e:"\u00eb",E:"\u00cb",i:"\u00ef",I:"\u00cf",o:"\u00f6",O:"\u00d6",u:"\u00fc",U:"\u00dc",y:"\u00ff",Y:"\u0178"},"^":{a:"\u00e2",A:"\u00c2",e:"\u00ea",E:"\u00ca",i:"\u00ee",I:"\u00ce",o:"\u00f4",O:"\u00d4",u:"\u00fb",U:"\u00db",y:"\u0177",Y:"\u0176"},"~":{a:"\u00e3",A:"\u00c3",e:"\u1ebd",E:"\u1ebc",i:"\u0129",I:"\u0128",o:"\u00f5",O:"\u00d5",u:"\u0169",U:"\u0168",y:"\u1ef9",Y:"\u1ef8",n:"\u00f1",N:"\u00d1"}}, validate:function(){return!0}};b.keyboard.comboRegex=/([`\'~\^\"ao])([a-z])/mig;b.fn.keyboard=function(f){return this.each(function(){b(this).data("keyboard")||new b.keyboard(this,f)})};b.fn.getkeyboard=function(){return this.data("keyboard")}})(jQuery);

(function(b,f,l,a){b.fn.caret=function(d,c){if("undefined"===typeof this[0]||this&&b(this).is(":hidden"))return!1;var e,k,i,g,h,j;e=document.selection;var m=this[0],o=m.scrollTop;j=window.opera&&"[object Opera]"===window.opera.toString();var n="undefined"!==typeof m.selectionStart;"number"===typeof d&&"number"===typeof c&&(i=d,h=c);if("undefined"!==typeof i)return n?("TEXTAREA"===m.tagName&&j&&(j=this.val(),e=j.substring(0,i).split("\n")[f]-1,i+=0<e?e:0,h+=0<e?e:0),m.selectionStart=i,m.selectionEnd= h):(e=m.createTextRange(),e.collapse(!0),e.moveStart("character",i),e.moveEnd("character",h-i),e.select()),b(m).focus(),m.scrollTop=o,this;n?(k=m.selectionStart,g=m.selectionEnd,"TEXTAREA"===m.tagName&&j&&(j=this.val(),e=j.substring(0,k).split("\n")[f]-1,k+=0<e?-e:0,g+=0<e?-e:0)):"TEXTAREA"===m.tagName?(j=this.val(),i=e[l](),h=i[a](),h.moveToElementText(m),h.setEndPoint("EndToEnd",i),k=h.text.replace(/\r\n/g,"\r")[f],g=k+i.text.replace(/\r\n/g,"\r")[f]):(j=this.val().replace(/\r\n/g,"\r"),i=e[l]()[a](), i.moveEnd("character",j[f]),k=""===i.text?j[f]:j.lastIndexOf(i.text),i=e[l]()[a](),i.moveStart("character",-j[f]),g=i.text[f]);i=m.value.substring(k,g);return{start:k,end:g,text:i,replace:function(a){return m.value.substring(0,k)+a+m.value.substring(g,m.value[f])}}}})(jQuery,"length","createRange","duplicate");